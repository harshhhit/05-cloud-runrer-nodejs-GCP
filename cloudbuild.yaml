steps:
  # Run SonarCloud analysis
  - name: 'gcr.io/sonarqube-scan'
    entrypoint: 'sonar-scanner'
  
    args: [
      '-Dsonar.organization=cleanmoutain \ ',
      '-Dsonar.projectKey=cleanmoutain_cleane \',
      '-Dsonar.sources=. \',
      '-Dsonar.host.url=https://sonarcloud.io',
      '-Dsonar.login=$_SONAR_TOKEN',
    ]


  # Build the Docker image
  - name: 'gcr.io/cloud-builders/docker'
    args: ['build', '-t', 'gcr.io/clean-mountain-395906/cloudsonarscner', '.']

  # Push the Docker image to Google Container Registry
  - name: 'gcr.io/cloud-builders/docker'
    args: ['push', 'gcr.io/clean-mountain-395906/cloudsonarscner']


images:
- 'gcr.io/clean-mountain-395906/cloudsonarscner'
